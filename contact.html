<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Content Security Policy -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://www.googletagmanager.com https://www.google-analytics.com https://static.addtoany.com; style-src 'self' 'unsafe-inline' https://static.addtoany.com; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://www.google-analytics.com https://s7.addtoany.com https://script.google.com https://script.googleusercontent.com; form-action 'self'; frame-src 'none'; object-src 'none'; base-uri 'self';">
  
  <!-- SEO Meta æ¨™ç±¤ -->
  <title>è¯çµ¡æˆ‘å€‘ - å•é¡Œåé¥‹ & è³‡æ–™æä¾› | é»ƒåº­ç­ äº’å‹•ç¶²ç«™</title>
  <meta name="description" content="é‡åˆ°å•é¡Œã€æƒ³è£œå……è³‡è¨Šæˆ–æå‡ºæ–°åŠŸèƒ½å»ºè­°ï¼Ÿæ­¡è¿é€éè¯çµ¡è¡¨å–®ç•™è¨€ï¼ˆå¯é™„ä¸Šç›¸é—œé€£çµæˆ–èªªæ˜ï¼‰ï¼Œæˆ‘å€‘æœƒåœ¨ç¢ºèªå¾Œç›¡å¿«å›è¦†èˆ‡è™•ç†ã€‚">
  <meta name="keywords" content="è¯çµ¡,å•é¡Œåé¥‹,è³‡æ–™æä¾›,æ–°åŠŸèƒ½å»ºè­°,é»ƒåº­ç­ ">
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://tingyuun.github.io/contact.html">
  
  <!-- Open Graph -->
  <meta property="og:title" content="è¯çµ¡æˆ‘å€‘ - é»ƒåº­ç­ äº’å‹•ç¶²ç«™">
  <meta property="og:description" content="é‡åˆ°å•é¡Œã€æƒ³è£œå……è³‡è¨Šæˆ–æå‡ºæ–°åŠŸèƒ½å»ºè­°ï¼Ÿæ­¡è¿é€éè¯çµ¡è¡¨å–®ç•™è¨€ï¼ˆå¯é™„ä¸Šç›¸é—œé€£çµæˆ–èªªæ˜ï¼‰ï¼Œæˆ‘å€‘æœƒåœ¨ç¢ºèªå¾Œç›¡å¿«å›è¦†èˆ‡è™•ç†ã€‚">
  <meta property="og:url" content="https://tingyuun.github.io/contact.html">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://tingyuun.github.io/images/profiles/1.png">
  <meta property="og:site_name" content="é»ƒåº­ç­ äº’å‹•ç¶²ç«™">
  <meta property="og:locale" content="zh_TW">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="è¯çµ¡æˆ‘å€‘ - é»ƒåº­ç­ äº’å‹•ç¶²ç«™">
  <meta name="twitter:description" content="é‡åˆ°å•é¡Œã€æƒ³è£œå……è³‡è¨Šæˆ–æå‡ºæ–°åŠŸèƒ½å»ºè­°ï¼Ÿæ­¡è¿é€éè¯çµ¡è¡¨å–®ç•™è¨€ï¼ˆå¯é™„ä¸Šç›¸é—œé€£çµæˆ–èªªæ˜ï¼‰ï¼Œæˆ‘å€‘æœƒåœ¨ç¢ºèªå¾Œç›¡å¿«å›è¦†èˆ‡è™•ç†ã€‚">
  <meta name="twitter:image" content="https://tingyuun.github.io/images/profiles/1.png">
  
  <!-- æˆäººå…§å®¹æ¨™è¨˜ -->
  <meta name="rating" content="adult">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#ff1493">
  <link rel="icon" type="image/png" href="images/favicon.png">
  
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FCK2EQM41Z"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-FCK2EQM41Z');
  </script>
  
  <!-- å…±ç”¨æ¨£å¼ -->
  <link rel="stylesheet" href="css/common.css">
  
  <style>
    .form-container {
      max-width: 700px;
      margin: 40px auto;
      padding: 40px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 20px;
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 255, 255, 0.1);
    }
    
    .form-group {
      margin-bottom: 25px;
    }
    
    .form-label {
      display: block;
      color: #fff;
      margin-bottom: 10px;
      font-weight: 600;
      font-size: 16px;
    }
    
    .form-input,
    .form-select,
    .form-textarea {
      width: 100%;
      padding: 14px 16px;
      border-radius: 10px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      font-size: 15px;
      transition: all 0.3s;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }
    
    .form-input:focus,
    .form-select:focus,
    .form-textarea:focus {
      outline: none;
      border-color: rgba(102, 126, 234, 0.8);
      background: rgba(255, 255, 255, 0.15);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
    }
    
    .form-select option {
      background: #1a1a2e;
      color: #fff;
    }
    
    .form-textarea {
      resize: vertical;
      min-height: 150px;
    }
    
    .form-hint {
      display: block;
      color: rgba(255, 255, 255, 0.6);
      font-size: 13px;
      margin-top: 6px;
    }
    
    .submit-btn {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 17px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }
    
    .submit-btn:active {
      transform: translateY(0);
    }
    
    .form-footer {
      text-align: center;
      color: rgba(255, 255, 255, 0.7);
      font-size: 14px;
      margin-top: 20px;
      line-height: 1.6;
    }
    
    .info-boxes {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }
    
    .info-box {
      background: rgba(255, 255, 255, 0.05);
      padding: 25px;
      border-radius: 15px;
      text-align: center;
      border: 2px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s;
    }
    
    .info-box:hover {
      transform: translateY(-5px);
      border-color: rgba(255, 105, 180, 0.5);
      box-shadow: 0 8px 20px rgba(255, 105, 180, 0.3);
    }
    
    .info-box-icon {
      font-size: 40px;
      margin-bottom: 10px;
    }
    
    .info-box-title {
      color: #fff;
      font-weight: 600;
      margin-bottom: 8px;
    }
    
    .info-box-text {
      color: rgba(255, 255, 255, 0.7);
      font-size: 14px;
    }
  </style>
</head>
<body>
  <!-- å°èˆª -->
  <nav class="main-nav">
    <div class="nav-container">
      <a href="/" class="nav-logo">é»ƒåº­ç­ </a>
      <ul class="nav-menu">
        <li><a href="/">é¦–é </a></li>
        <li><a href="/about.html">é—œæ–¼å¥¹</a></li>
        <li><a href="/gallery.html">ç…§ç‰‡é›†</a></li>
        <li><a href="/story.html">äº‹ä»¶å§‹æœ«</a></li>
        <li><a href="/faq.html">å¸¸è¦‹å•é¡Œ</a></li>
        <li><a href="/resources.html">è³‡æºé€£çµ</a></li>
        <li><a href="/contact.html" class="active">è¯çµ¡æˆ‘å€‘</a></li>
      </ul>
      <div class="nav-toggle">â˜°</div>
    </div>
  </nav>

  <!-- éºµåŒ…å±‘ -->
  <nav class="breadcrumb">
    <a href="/">é¦–é </a> <span>></span> è¯çµ¡æˆ‘å€‘
  </nav>

  <!-- ä¸»è¦å…§å®¹ -->
  <div class="page-container">
    <h1 class="page-title">ğŸ“® è¯çµ¡æˆ‘å€‘</h1>
    <p class="page-subtitle">å•é¡Œåé¥‹ Â· è³‡æ–™æä¾› Â· æ–°åŠŸèƒ½å»ºè­°</p>
    
    <!-- AddToAny åˆ†äº«æŒ‰éˆ• -->
    <div class="a2a_kit a2a_kit_size_32 a2a_default_style" style="text-align: center; margin: 20px 0; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 10px; backdrop-filter: blur(10px);">
      <span style="color: #fff; margin-right: 10px; font-weight: 500;">ğŸ“¤ åˆ†äº«æ­¤é :</span>
      <a class="a2a_button_facebook"></a>
      <a class="a2a_button_twitter"></a>
      <a class="a2a_button_line"></a>
      <a class="a2a_button_telegram"></a>
      <a class="a2a_button_whatsapp"></a>
      <a class="a2a_button_copy_link"></a>
      <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
    </div>

    <div class="content-card fade-in">
      <!-- è³‡è¨Šå¡ç‰‡ -->
      <div class="info-boxes">
        <div class="info-box">
          <div class="info-box-icon">ğŸ›</div>
          <div class="info-box-title">å•é¡Œåé¥‹</div>
          <div class="info-box-text">ç™¼ç¾éŒ¯èª¤æˆ–åŠŸèƒ½ç•°å¸¸?è«‹å‘Šè¨´æˆ‘å€‘</div>
        </div>
        <div class="info-box">
          <div class="info-box-icon">ğŸ“‚</div>
          <div class="info-box-title">è³‡æ–™æä¾›</div>
          <div class="info-box-text">æœ‰æ›´å¤šç…§ç‰‡æˆ–å½±ç‰‡è³‡æº?æ­¡è¿åˆ†äº«</div>
        </div>
        <div class="info-box">
          <div class="info-box-icon">ğŸ’¡</div>
          <div class="info-box-title">åŠŸèƒ½å»ºè­°</div>
          <div class="info-box-text">æƒ³è¦ä»€éº¼æ–°åŠŸèƒ½?æˆ‘å€‘æ´—è€³æ­è½</div>
        </div>
        <div class="info-box">
          <div class="info-box-icon">ğŸ”—</div>
          <div class="info-box-title">é€£çµå¤±æ•ˆ</div>
          <div class="info-box-text">ç™¼ç¾ç„¡æ³•ä½¿ç”¨çš„é€£çµ?ç«‹å³å›å ±</div>
        </div>
      </div>

      <!-- è¡¨å–® -->
      <div class="form-container">
        <h2 style="text-align: center; color: #fff; margin-bottom: 30px;">
          âœ‰ï¸ å¡«å¯«è¡¨å–®
        </h2>
        
        <form id="contact-form" action="#" method="POST" enctype="multipart/form-data" novalidate>
          <!-- Honeypot (bots): humans should leave empty -->
          <input type="text" name="website" autocomplete="off" tabindex="-1" aria-hidden="true" style="position:absolute; left:-9999px; width:1px; height:1px; opacity:0;">
          <div class="form-group">
            <label for="feedback-type" class="form-label">å•é¡Œé¡å‹ *</label>
            <select id="feedback-type" name="type" class="form-select" required>
              <option value="">è«‹é¸æ“‡...</option>
              <option value="å•é¡Œåé¥‹">ğŸ› å•é¡Œåé¥‹</option>
              <option value="è³‡æ–™æä¾›">ğŸ“‚ è³‡æ–™æä¾›</option>
              <option value="æ–°åŠŸèƒ½å»ºè­°">ğŸ’¡ æ–°åŠŸèƒ½å»ºè­°</option>
              <option value="é€£çµå¤±æ•ˆ">ğŸ”— é€£çµå¤±æ•ˆå›å ±</option>
              <option value="å…¶ä»–">ğŸ“ å…¶ä»–</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="feedback-title" class="form-label">æ¨™é¡Œ *</label>
            <input 
              type="text" 
              id="feedback-title" 
              name="title" 
              class="form-input" 
              placeholder="ç°¡çŸ­æè¿°ä½ çš„å•é¡Œæˆ–å»ºè­°" 
              required
            >
          </div>
          
          <div class="form-group">
            <label for="feedback-message" class="form-label">è©³ç´°æè¿° *</label>
            <textarea 
              id="feedback-message" 
              name="message" 
              class="form-textarea" 
              placeholder="è«‹è©³ç´°æè¿°ä½ çš„å•é¡Œã€æä¾›çš„è³‡æ–™æˆ–å»ºè­°...&#10;&#10;ä¾‹å¦‚:&#10;â€¢ ç™¼ç”Ÿå•é¡Œçš„é é¢å’Œæ­¥é©Ÿ&#10;â€¢ ä½ æƒ³æä¾›çš„è³‡æ–™é¡å‹&#10;â€¢ ä½ æœŸæœ›çš„åŠŸèƒ½æ•ˆæœ" 
              required
            ></textarea>
          </div>
          
          <div class="form-group">
            <label for="feedback-email" class="form-label">é›»å­éƒµä»¶ (é¸å¡«)</label>
            <input 
              type="email" 
              id="feedback-email" 
              name="email" 
              class="form-input" 
              placeholder="example@email.com"
            >
            <small class="form-hint">å¦‚éœ€å›è¦†è«‹ç•™ä¸‹æ‚¨çš„ Email</small>
          </div>
          
          <div class="form-group">
            <label for="feedback-file" class="form-label">é™„ä»¶ (é¸å¡«)</label>
            <input 
              type="file" 
              id="feedback-file" 
              name="attachment" 
              class="form-input" 
              accept="image/*,video/*,.pdf,.zip"
            >
            <small class="form-hint" id="file-upload-hint">æ”¯æ´åœ–ç‰‡ã€å½±ç‰‡ã€PDFã€ZIP æª”æ¡ˆï¼›ç‚ºç¢ºä¿ Google é›²ç«¯ä¸Šå‚³ç©©å®šï¼Œå»ºè­° â‰¤ 7MBã€‚æ›´å¤§çš„æª”æ¡ˆè«‹æ”¹è²¼é›²ç«¯é€£çµã€‚</small>
          </div>

          <div class="form-group" style="margin-top: 10px;">
            <div id="form-status" role="status" aria-live="polite" aria-atomic="true" style="display:none; padding: 12px 14px; border-radius: 10px; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.15); color: rgba(255,255,255,0.9);"></div>
          </div>

          <noscript>
            <div style="margin-top: 10px; padding: 12px 14px; border-radius: 10px; background: rgba(255,255,255,0.08); border: 1px solid rgba(255, 179, 179, 0.15); color: #ffb3b3;">
              âš ï¸ é€å‡ºè¡¨å–®éœ€è¦å•Ÿç”¨ JavaScriptã€‚
            </div>
          </noscript>
          
          <button type="submit" class="submit-btn" id="contact-submit" onclick="if (typeof gtag === 'function') gtag('event', 'form_submit', {event_category: 'Contact', event_label: 'Feedback_Form'});">
            ğŸ“¤ é€å‡ºè¡¨å–®
          </button>
          
          <div class="form-footer">
            <p>æäº¤å¾Œæˆ‘å€‘æœƒç›¡å¿«è™•ç†ä½ çš„åé¥‹</p>
            <p>æ„Ÿè¬ä½ å¹«åŠ©æˆ‘å€‘æ”¹é€²ç¶²ç«™! â¤ï¸</p>
          </div>
        </form>
      </div>
    </div>

    <!-- ç›¸é—œé€£çµ -->
    <section class="content-card fade-in" style="margin-top: 40px;">
      <h2 style="text-align: center; margin-bottom: 30px;">ğŸ”— å…¶ä»–é€£çµ</h2>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
        <a href="/gallery.html" style="text-decoration: none; background: rgba(255,255,255,0.15); padding: 25px; border-radius: 15px; transition: all 0.3s; border: 2px solid rgba(255,105,180,0.3);" onmouseover="this.style.transform='translateY(-5px)'; this.style.borderColor='rgba(255,105,180,0.8)'" onmouseout="this.style.transform='translateY(0)'; this.style.borderColor='rgba(255,105,180,0.3)'">
          <h3 style="color: #ff69b4; margin-bottom: 10px; font-size: 20px;">ğŸ“¸ ç…§ç‰‡é›†</h3>
          <p style="color: rgba(255,255,255,0.9); font-size: 14px;">å®Œæ•´é«˜æ¸…ç…§ç‰‡å’Œå½±ç‰‡æ”¶è—</p>
        </a>
        <a href="/resources.html" style="text-decoration: none; background: rgba(255,255,255,0.15); padding: 25px; border-radius: 15px; transition: all 0.3s; border: 2px solid rgba(102,126,234,0.3);" onmouseover="this.style.transform='translateY(-5px)'; this.style.borderColor='rgba(102,126,234,0.8)'" onmouseout="this.style.transform='translateY(0)'; this.style.borderColor='rgba(102,126,234,0.3)'">
          <h3 style="color: #667eea; margin-bottom: 10px; font-size: 20px;">ğŸ“¦ è³‡æºé€£çµ</h3>
          <p style="color: rgba(255,255,255,0.9); font-size: 14px;">ä¸‹è¼‰é€£çµå’Œç›¸é—œè³‡æº</p>
        </a>
        <a href="/faq.html" style="text-decoration: none; background: rgba(255,255,255,0.15); padding: 25px; border-radius: 15px; transition: all 0.3s; border: 2px solid rgba(148,0,211,0.3);" onmouseover="this.style.transform='translateY(-5px)'; this.style.borderColor='rgba(148,0,211,0.8)'" onmouseout="this.style.transform='translateY(0)'; this.style.borderColor='rgba(148,0,211,0.3)'">
          <h3 style="color: #9400d3; margin-bottom: 10px; font-size: 20px;">â“ å¸¸è¦‹å•é¡Œ</h3>
          <p style="color: rgba(255,255,255,0.9); font-size: 14px;">å¸¸è¦‹ç–‘å•å¿«é€Ÿè§£ç­”</p>
        </a>
      </div>
    </section>
  </div>

  <!-- é è…³ -->
  <footer class="page-footer">
    <div class="footer-content">
      <div class="footer-links">
        <a href="/">é¦–é </a>
        <a href="/about.html">é—œæ–¼</a>
        <a href="/gallery.html">ç…§ç‰‡</a>
        <a href="/resources.html">è³‡æº</a>
        <a href="/contact.html">è¯çµ¡</a>
        <a href="/disclaimer.html">å…è²¬è²æ˜</a>
      </div>
      <p class="footer-text">
        Â© 2025 é»ƒåº­ç­ äº’å‹•ç¶²ç«™ | 18+ é™å®š | 
        <a href="https://cc.shu.edu.tw/" target="_blank" rel="noopener noreferrer" style="color: rgba(255,255,255,0.9); text-decoration: underline;">ä¸–æ–°å¤§å­¸å‚³æ’­ç®¡ç†å­¸ç³»</a>
      </p>
      <p style="font-size: 11px; color: rgba(255, 255, 255, 0.5); margin-top: 5px;">
        æœ¬ç«™å…§å®¹åƒ…ä¾›è³‡è¨Šåƒè€ƒ,ä¸å°ç¬¬ä¸‰æ–¹é€£çµè² è²¬
      </p>
      
      <!-- FlagCounter è¨ªå®¢çµ±è¨ˆ -->
      <div class="flag-counter" style="text-align: center; margin: 20px 0;">
        <a href="https://info.flagcounter.com/ckwX" target="_blank" rel="noopener">
          <img src="https://s01.flagcounter.com/count/ckwX/bg_FFFFFF/txt_000000/border_CCCCCC/columns_5/maxflags_10/viewers_cums/labels_0/pageviews_0/flags_0/percent_0/" 
            alt="è¨ªå®¢ä¾†æºçµ±è¨ˆï¼ˆFlagCounterï¼‰" 
               border="0"
               loading="lazy">
        </a>
      </div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script defer src="js/common.js"></script>

  <script>
    (function () {
      // Google Apps Script + base64 overhead => keep a conservative limit
      const MAX_BYTES = 7 * 1024 * 1024;

      // Replace with your Apps Script Web App URL
      const CONTACT_UPLOAD_API = 'https://script.google.com/macros/s/AKfycbxQDIOu5f8dT5g4FJVI487n0MkZoYlxCaI1Z4XGKrdKP0oe3THtfEu_2EW3Ze5HnZlu3w/exec';

      function formatSize(bytes) {
        if (!Number.isFinite(bytes)) return '';
        const mb = bytes / (1024 * 1024);
        return mb.toFixed(2) + ' MB';
      }

      function setHint(el, message, isError) {
        if (!el) return;
        el.textContent = message;
        el.style.color = isError ? '#ffb3b3' : 'rgba(255, 255, 255, 0.6)';
      }

      document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('contact-form');
        const fileInput = document.getElementById('feedback-file');
        const hint = document.getElementById('file-upload-hint');
        const statusEl = document.getElementById('form-status');
        const submitBtn = document.getElementById('contact-submit');

        if (!form || !fileInput) return;
        if (!CONTACT_UPLOAD_API || CONTACT_UPLOAD_API.indexOf('REPLACE_WITH_') === 0) {
          // Show a clear message so the page isn't misleading.
          if (statusEl) {
            statusEl.style.display = 'block';
            statusEl.style.borderColor = 'rgba(255, 179, 179, 0.35)';
            statusEl.style.color = '#ffb3b3';
            statusEl.textContent = 'âš ï¸ è¯çµ¡è¡¨å–®å°šæœªè¨­å®šä¸Šå‚³ç«¯é»ï¼ˆéœ€è¦éƒ¨ç½² Google Apps Script Web Appï¼‰ã€‚';
          }
          return;
        }

        const defaultHint = hint ? hint.textContent : '';

        function validateFile() {
          const file = fileInput.files && fileInput.files[0];
          if (!file) {
            setHint(hint, defaultHint, false);
            return { ok: true };
          }
          if (file.size > MAX_BYTES) {
            setHint(
              hint,
              `é™„ä»¶éå¤§ï¼ˆ${formatSize(file.size)}ï¼‰ï¼Œå»ºè­°æ”¹ç”¨ â‰¤ 7MB çš„æª”æ¡ˆæˆ–æ”¹è²¼é›²ç«¯é€£çµã€‚`,
              true
            );
            return { ok: false };
          }
          setHint(hint, defaultHint, false);
          return { ok: true };
        }

        function setStatus(message, isError, linkUrl) {
          if (!statusEl) return;
          statusEl.style.display = 'block';
          statusEl.style.borderColor = isError
            ? 'rgba(255, 179, 179, 0.35)'
            : 'rgba(179, 255, 205, 0.25)';
          statusEl.style.color = isError ? '#ffb3b3' : '#b3ffcd';
          statusEl.textContent = '';
          statusEl.appendChild(document.createTextNode(message));
          if (linkUrl) {
            statusEl.appendChild(document.createTextNode(' '));
            const a = document.createElement('a');
            a.href = linkUrl;
            a.target = '_blank';
            a.rel = 'noopener noreferrer';
            a.style.color = 'rgba(255,255,255,0.95)';
            a.style.textDecoration = 'underline';
            a.textContent = 'é–‹å•Ÿé™„ä»¶é€£çµ';
            statusEl.appendChild(a);
          }
        }

        function parseJsonOrNull(text) {
          try {
            return JSON.parse(text);
          } catch (_) {
            return null;
          }
        }

        function fileToBase64(file) {
          return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onerror = () => reject(new Error('read_failed'));
            reader.onload = () => {
              const result = String(reader.result || '');
              // data:[mime];base64,XXXX
              const idx = result.indexOf('base64,');
              if (idx === -1) return reject(new Error('base64_failed'));
              resolve(result.slice(idx + 'base64,'.length));
            };
            reader.readAsDataURL(file);
          });
        }

        fileInput.addEventListener('change', () => {
          const res = validateFile();
          if (!res.ok) fileInput.value = '';
        });

        form.addEventListener('submit', async (e) => {
          e.preventDefault();

          const res = validateFile();
          if (!res.ok) return;

          const type = (document.getElementById('feedback-type') || {}).value || '';
          const title = (document.getElementById('feedback-title') || {}).value || '';
          const message = (document.getElementById('feedback-message') || {}).value || '';
          const email = (document.getElementById('feedback-email') || {}).value || '';
          const website = (form.querySelector('input[name="website"]') || {}).value || '';

          if (!type || !title || !message) {
            setStatus('âš ï¸ è«‹å…ˆå¡«å¯«å¿…å¡«æ¬„ä½ï¼ˆå•é¡Œé¡å‹ã€æ¨™é¡Œã€è©³ç´°æè¿°ï¼‰ã€‚', true);
            return;
          }

          const file = fileInput.files && fileInput.files[0];
          let attachment = null;

          try {
            if (submitBtn) submitBtn.disabled = true;
            if (fileInput) fileInput.disabled = true;
            setStatus('â³ é€å‡ºä¸­â€¦', false);

            if (file) {
              const base64 = await fileToBase64(file);
              attachment = {
                name: file.name,
                type: file.type,
                size: file.size,
                base64
              };
            }

            // Send as text/plain to avoid CORS preflight.
            const payload = JSON.stringify({ type, title, message, email, website, attachment });

            const controller = new AbortController();
            const timeoutId = window.setTimeout(() => controller.abort(), 20000);

            const resp = await fetch(CONTACT_UPLOAD_API, {
              method: 'POST',
              cache: 'no-store',
              redirect: 'follow',
              headers: {
                'Content-Type': 'text/plain;charset=utf-8'
              },
              body: payload,
              signal: controller.signal
            }).finally(() => window.clearTimeout(timeoutId));

            const contentType = String(resp.headers.get('content-type') || '').toLowerCase();
            const rawText = await resp.text().catch(() => '');
            const data = parseJsonOrNull(rawText);

            if (!resp.ok) {
              setStatus('âŒ é€å‡ºå¤±æ•—ï¼ˆæœå‹™å›æ‡‰ç•°å¸¸ï¼‰ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚', true);
              return;
            }

            if (!data || data.ok !== true) {
              // Apps Script may return HTML error pages (e.g. deployment not updated / permissions).
              if (contentType.indexOf('text/html') !== -1 || rawText.indexOf('<html') !== -1) {
                setStatus('âŒ é€å‡ºå¤±æ•—ï¼ˆæœå‹™ç«¯æœªå›å‚³ JSONï¼‰ã€‚è«‹ç¢ºèª Apps Script å·²éƒ¨ç½²ç‚º Web Appã€æ¬Šé™ç‚ºã€Œä»»ä½•äººã€ï¼Œä¸¦é‡æ–°éƒ¨ç½²æœ€æ–°ç‰ˆã€‚', true);
                return;
              }

              const errCode = data && data.error ? String(data.error) : '';
              const msg = errCode === 'file_type_not_allowed'
                ? 'âŒ æª”æ¡ˆé¡å‹ä¸æ”¯æ´ï¼ˆåƒ…åœ–ç‰‡/å½±ç‰‡/PDF/ZIPï¼‰ã€‚'
                : errCode === 'file_too_large'
                  ? 'âŒ é™„ä»¶éå¤§ï¼ˆå»ºè­° â‰¤ 7MBï¼‰ã€‚'
                  : errCode === 'missing_required_fields'
                    ? 'âŒ ç¼ºå°‘å¿…å¡«æ¬„ä½ï¼Œè«‹æª¢æŸ¥å¾Œå†é€å‡ºã€‚'
                    : errCode === 'server_not_configured'
                      ? 'âŒ æœå‹™ç«¯å°šæœªè¨­å®šï¼ˆDrive è³‡æ–™å¤¾ ID æœªå¡«ï¼‰ã€‚'
                      : 'âŒ é€å‡ºå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ï¼›æˆ–æ”¹ç”¨ã€Œè²¼é›²ç«¯é€£çµã€æ–¹å¼æä¾›é™„ä»¶ã€‚';
              setStatus(msg, true);
              return;
            }

            if (data.fileUrl) {
              setStatus('âœ… å·²é€å‡ºï¼é™„ä»¶å·²ä¸Šå‚³åˆ° Google é›²ç«¯ã€‚', false, String(data.fileUrl));
            } else {
              setStatus('âœ… å·²é€å‡ºï¼æˆ‘å€‘æœƒç›¡å¿«è™•ç†ä½ çš„åé¥‹ã€‚', false);
            }
            form.reset();
            setHint(hint, defaultHint, false);
          } catch (err) {
            const aborted = err && String(err.name || '') === 'AbortError';
            setStatus(aborted
              ? 'âŒ é€å‡ºé€¾æ™‚ï¼ˆ20 ç§’ï¼‰ã€‚è«‹æª¢æŸ¥ç¶²è·¯æˆ–ç¨å¾Œå†è©¦ã€‚'
              : 'âŒ é€å‡ºå¤±æ•—ï¼ˆç¶²è·¯æˆ–æœå‹™ç•°å¸¸ï¼‰ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚', true);
          } finally {
            if (submitBtn) submitBtn.disabled = false;
            if (fileInput) fileInput.disabled = false;
          }
        });
      });
    })();
  </script>
  
  <!-- AddToAny åˆ†äº«æŒ‰éˆ•è…³æœ¬ -->
  <script async src="https://static.addtoany.com/menu/page.js"></script>
</body>
</html>
